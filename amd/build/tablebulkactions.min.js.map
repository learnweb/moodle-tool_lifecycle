{"version":3,"file":"tablebulkactions.min.js","sources":["../src/tablebulkactions.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for checkboxed table.\n * @module     tool_lifecycle/tablebulkactions\n * @copyright  2021 Justus Dieckmann WWU\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Helper function to redirect via POST\n * @param {String} url redirect to\n * @param {Array} data redirect with data\n */\nfunction redirectPost(url, data) {\n    const form = document.createElement('form');\n    document.body.appendChild(form);\n    form.method = 'post';\n    form.action = url;\n    for (const pair of data) {\n        const input = document.createElement('input');\n        input.type = 'hidden';\n        input.name = pair.k;\n        input.value = pair.v;\n        form.appendChild(input);\n    }\n    form.submit();\n}\n\n/**\n * Init function\n */\nexport function init() {\n    const checkboxes = document.querySelectorAll('input[name=\"procerror-select\"]');\n\n    const action = document.querySelectorAll('*[data-lifecycle-action]');\n    action.forEach((a) => {\n        a.onclick = (e) => {\n            e.preventDefault();\n            let data = [\n                {k: 'action', v: a.getAttribute('data-lifecycle-action')},\n                {k: 'sesskey', v: M.cfg.sesskey}\n            ];\n            if (a.getAttribute('data-lifecycle-forall') === '1') {\n                data.push({k: 'all', v: '1'});\n                redirectPost(window.location, data);\n            } else  {\n                checkboxes.forEach((c) => {\n                    if (c.checked) {\n                        data.push({k: 'id[]', v: c.value});\n                    }\n                });\n                redirectPost(window.location, data);\n            }\n        };\n    });\n}"],"names":["redirectPost","url","data","form","document","createElement","body","appendChild","method","action","pair","input","type","name","k","value","v","submit","checkboxes","querySelectorAll","forEach","a","onclick","e","preventDefault","getAttribute","M","cfg","sesskey","push","window","location","c","checked"],"mappings":";;;;;;;SA2BSA,aAAaC,IAAKC,YACjBC,KAAOC,SAASC,cAAc,QACpCD,SAASE,KAAKC,YAAYJ,MAC1BA,KAAKK,OAAS,OACdL,KAAKM,OAASR,QACT,MAAMS,QAAQR,KAAM,OACfS,MAAQP,SAASC,cAAc,SACrCM,MAAMC,KAAO,SACbD,MAAME,KAAOH,KAAKI,EAClBH,MAAMI,MAAQL,KAAKM,EACnBb,KAAKI,YAAYI,OAErBR,KAAKc,gGAOCC,WAAad,SAASe,iBAAiB,kCAE9Bf,SAASe,iBAAiB,4BAClCC,SAASC,IACZA,EAAEC,QAAWC,IACTA,EAAEC,qBACEtB,KAAO,CACP,CAACY,EAAG,SAAUE,EAAGK,EAAEI,aAAa,0BAChC,CAACX,EAAG,UAAWE,EAAGU,EAAEC,IAAIC,UAEoB,MAA5CP,EAAEI,aAAa,0BACfvB,KAAK2B,KAAK,CAACf,EAAG,MAAOE,EAAG,MACxBhB,aAAa8B,OAAOC,SAAU7B,QAE9BgB,WAAWE,SAASY,IACZA,EAAEC,SACF/B,KAAK2B,KAAK,CAACf,EAAG,OAAQE,EAAGgB,EAAEjB,WAGnCf,aAAa8B,OAAOC,SAAU7B"}